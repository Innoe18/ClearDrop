{% extends "base.html" %}
{% block title %}Logs • ClearDrop{% endblock %}

{% block content %}
<div class="rounded-3xl bg-white/75 backdrop-blur border border-white shadow-soft p-6">
  <div class="flex items-start justify-between gap-4 flex-wrap">
    <div>
      <h1 class="text-2xl font-bold">Telemetry Logs</h1>
      <p class="text-sm text-slate-500 mt-1">Browse readings stored in RDS.</p>
    </div>

    <form method="get" class="flex items-end gap-3 flex-wrap">
      <div>
        <label class="text-sm text-slate-600">Device</label>
        <select name="device_id"
          class="mt-1 px-4 py-2 rounded-2xl bg-white border border-slate-200 focus:outline-none focus:ring-2 focus:ring-aqua-300">
          {% for d in devices %}
            <option value="{{ d.device_id }}" {% if d.device_id == selected_device %}selected{% endif %}>
              {{ d.nickname or d.device_id }}
            </option>
          {% endfor %}
        </select>
      </div>

      <div>
        <label class="text-sm text-slate-600">Limit</label>
        <input name="limit" type="number" value="{{ limit }}" min="10" max="1000"
          class="mt-1 w-28 px-4 py-2 rounded-2xl bg-white border border-slate-200 focus:outline-none focus:ring-2 focus:ring-aqua-300">
      </div>

      <button type="submit"
        class="px-4 py-2 rounded-2xl text-sm font-semibold text-white shadow-soft
               bg-gradient-to-r from-aqua-500 to-lavender-500 hover:opacity-95 transition">
        Apply
      </button>
    </form>
  </div>

  <div class="mt-5 overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead>
        <tr class="text-left text-slate-500">
          <th class="py-2">Timestamp</th>
          <th class="py-2">Device</th>
          <th class="py-2">Temp (°C)</th>
          <th class="py-2">TDS (ppm)</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-100">
        {% for r in rows %}
          <tr class="hover:bg-aqua-50/40 transition">
            <td class="py-3 whitespace-nowrap">{{ r.ts }}</td>
            <td class="py-3">{{ r.device_id }}</td>
            <td class="py-3 font-semibold">{{ "%.1f"|format(r.temp_c) }}</td>
            <td class="py-3 font-semibold">{{ r.tds_ppm }}</td>
          </tr>
        {% endfor %}
        {% if rows|length == 0 %}
          <tr><td colspan="4" class="py-6 text-slate-500">No data yet.</td></tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
